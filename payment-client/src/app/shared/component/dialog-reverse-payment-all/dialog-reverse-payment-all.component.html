<div mat-dialog-title>
  <button (click)="onNoClick()" class="close" mat-button>X</button>
  <h1 cdkDrag cdkDragHandle cdkDragRootElement=".cdk-overlay-pane">
    <b>ยกเลิกเอกสารจ่ายทั้งหมด</b>
  </h1>
</div>
<div [hidden]="!isConfirm" mat-dialog-content style="width: 1200px;">
  <div [hidden]="dataSource.data.length === 0" class="content-box">
    <div class="position-relative" style="overflow-y: auto; max-height: 500px;">
      <div style="overflow: auto;">
        <table [dataSource]="dataSource" class="mat-elevation-z8" mat-table matSort>
          <ng-container matColumnDef="choose">
            <th *matHeaderCellDef class="info" mat-header-cell>เลือก</th>
            <td *matCellDef="let element" mat-cell>
              <mat-icon (click)="viewDocument(element)" class="icon pointer">
                folder_open
              </mat-icon>
            </td>
          </ng-container>

          <ng-container matColumnDef="paymentCompanyCode">
            <th *matHeaderCellDef class="info" mat-header-cell>รหัสหน่วยงานเอกสารจ่าย</th>
            <td *matCellDef="let element" mat-cell>
              {{ element.paymentCompanyCode }}
            </td>
          </ng-container>

          <ng-container matColumnDef="paymentDocumentNo">
            <th *matHeaderCellDef class="info" mat-header-cell mat-sort-header>เลขที่เอกสารจ่าย</th>
            <td *matCellDef="let element" mat-cell>
              {{ element.paymentDocumentNo }}
            </td>
          </ng-container>

          <ng-container matColumnDef="paymentFiscalYear">
            <th *matHeaderCellDef class="info" mat-header-cell mat-sort-header>ปีเอกสารจ่าย</th>
            <td *matCellDef="let element" mat-cell>
              {{ element.paymentFiscalYear }}
            </td>
          </ng-container>

          <ng-container matColumnDef="reversePaymentCompanyCode">
            <th *matHeaderCellDef class="info" mat-header-cell>รหัสหน่วยงานกลับรายการเอกสารจ่าย</th>
            <td *matCellDef="let element" mat-cell>
              {{ element.reversePaymentCompanyCode }}
            </td>
          </ng-container>

          <ng-container matColumnDef="reversePaymentDocumentNo">
            <th *matHeaderCellDef class="info" mat-header-cell mat-sort-header>
              เลขที่กลับรายการเอกสารจ่าย
            </th>
            <td *matCellDef="let element" mat-cell>
              {{ element.reversePaymentDocumentNo }}
            </td>
          </ng-container>

          <ng-container matColumnDef="reversePaymentFiscalYear">
            <th *matHeaderCellDef class="info" mat-header-cell mat-sort-header>
              ปีกลับรายการเอกสารจ่าย
            </th>
            <td *matCellDef="let element" mat-cell>
              {{ element.reversePaymentFiscalYear }}
            </td>
          </ng-container>

          <tr *matHeaderRowDef="displayedColumns; sticky: true" mat-header-row></tr>
          <tr
            (click)="row.highlighted = !row.highlighted"
            (mouseout)="row.hovered = false"
            (mouseover)="row.hovered = true"
            *matRowDef="let row; columns: displayedColumns"
            [ngClass]="{ hovered: row.hovered, highlighted: row.highlighted }"
            mat-row
          ></tr>
        </table>
      </div>
      <div class="footer-table-summary">
        <div class="summary-result">
          <p>จำนวนรายการเอกสารทั้งหมด : {{ summaryResult?.total }} รายการ</p>
          <p>กำลังประมวลผล : {{ summaryResult?.process }} รายการ</p>
          <p>สำเร็จ : {{ summaryResult?.success }} รายการ</p>
          <p>ไม่สำเร็จ : {{ summaryResult?.fail }} รายการ</p>
        </div>
        <mat-paginator
          [pageSizeOptions]="[5, 10, 20, 50, 100]"
          showFirstLastButtons
        ></mat-paginator>
      </div>
    </div>
    <div class="row mx-auto mt-3 border-t-black">
      <div class="mx-auto d-flex">
        <button (click)="onNoClick()" class="btn-light" type="button">ปิด</button>
        <button (click)="pullPaymentDocument()" class="btn-light" type="button">refresh</button>
      </div>
    </div>
  </div>
  <div [hidden]="dataSource.data.length !== 0" class="content-box">
    <div class="row">
      <div class="col-md-12 text-left">
        <label class="text-black">กลับรายการเอกสารจ่ายเสร็จหมดแล้ว</label>
      </div>
    </div>
    <hr class="under-title"/>
    <div class="mx-auto d-flex">
      <button (click)="onNoClick()" class="btn-light" type="button">ปิด</button>
    </div>
  </div>
</div>
<div [hidden]="isConfirm" mat-dialog-content style="width: 500px;">
  <div class="content-box">
    <div class="row">
      <div class="col-md-12 text-left">
        <label class="text-black">ยืนยันการยกเลิกเอกสารจ่ายทั้งหมด</label>
      </div>
    </div>
    <form (keydown.enter)="$event.preventDefault()" [formGroup]="reverseForm">
      <div class="row margin-tb-size">
        <div class="col-md-12 text-left">
          <label class="text-black input-head">วันที่ประมวลผล</label>
        </div>
        <div class="col-md-12">
          <div class="input-group datetime-input">
            <div class="box-instead-input">
              <input
                [matDatepicker]="paymentDatePicker"
                class="form-control"
                formControlName="paymentDate"
                type="text"
                appDateInput
              />
            </div>
            <div class="datetime-input-append">
              <button (click)="paymentDatePicker.open()" class="btn-calendar-icon" type="button">
                <img src="assets/images/icon/calendar.svg" width="12px"/>
                <mat-datepicker #paymentDatePicker></mat-datepicker>
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="row margin-tb-size">
        <div class="col-md-12 text-left">
          <label class="text-black input-head">รหัส</label>
        </div>
        <div class="col-md-12">
          <input
            class="form-control"
            formControlName="paymentName"
            type="text"
            maxlength="5"
            appUpperCaseDirective
          />
        </div>
      </div>
      <div class="row margin-tb-size">
        <div class="col-md-12 text-left">
          <label class="text-underline-red input-head">เหตุผลการกลับรายการ</label>
        </div>
        <div class="col-md-12">
          <select
            class="form-control"
            formControlName="reasonReverse"
            (ngModelChange)="onChangeReason($event)"
          >
            <option *ngFor="let item of constant.LIST_REASON_BACK_LIST" [ngValue]="item.id">{{
                item.name
              }}
            </option>
          </select>
        </div>
      </div>
      <div class="row margin-tb-size">
        <div class="col-md-12 text-left">
          <label class="text-black input-head">วันที่ผ่านรายการ</label>
        </div>
        <div class="col-md-12">
          <div class="input-group datetime-input">
            <div class="box-instead-input">
              <input
                [matDatepicker]="reverseDatePicker"
                class="form-control"
                formControlName="reverseDate"
                type="text"
                appDateInput
              />
            </div>
            <div class="datetime-input-append">
              <button (click)="reverseDatePicker.open()" class="btn-calendar-icon" type="button">
                <img src="assets/images/icon/calendar.svg" width="12px"/>
                <mat-datepicker #reverseDatePicker></mat-datepicker>
              </button>
            </div>
          </div>
        </div>
      </div>
    </form>
    <ul class="warning-box">
      <li *ngFor="let c of listValidate">{{ c }}</li>
    </ul>
    <hr class="under-title"/>
    <div class="mx-auto d-flex">
      <button (click)="clickConfirm()" class="btn btn-success btn-lg" type="button">
        ใช่
      </button>
      <button (click)="clickCancel()" class="btn btn-danger btn-lg" type="button">
        ไม่ใช่
      </button>
    </div>
  </div>
</div>
